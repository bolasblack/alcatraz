[{"id":0,"href":"/alcatraz/quickstart/","title":"Quickstart","section":"Alcatraz Documentation","content":"Quickstart Guide# Set up a secure sandbox for your AI code agent in under 5 minutes. After this guide, your agent will have full autonomy inside the container while your host system stays protected.\nInstallation# Go Install# go install github.com/bolasblack/alcatraz/cmd/alca@latestNix# nix profile install github:bolasblack/alcatrazBuild from Source# git clone https://github.com/bolasblack/alcatraz.git cd alcatraz make buildThe binary is created at out/bin/alca. Add it to your PATH:\nexport PATH=\u0026#34;$PWD/out/bin:$PATH\u0026#34;Basic Commands# Command Description alca init Create .alca.toml configuration alca up Start container alca run \u0026lt;cmd\u0026gt; Execute command in container alca down Stop and remove container alca status Show container status and config info Your First Container# Step 1: Initialize# Navigate to your project directory and initialize Alcatraz:\ncd my-project alca initYou\u0026rsquo;ll be prompted to select a template:\n? Select a template: \u0026gt; Nix - NixOS-based development environment Debian - Debian-based environment with miseThis creates a .alca.toml tailored to the selected preset. For example, the Nix preset generates:\nimage = \u0026#34;nixos/nix\u0026#34; [commands] # prebuild, to reduce the time costs on enter up = \u0026#34;[ -f flake.nix ] \u0026amp;\u0026amp; exec nix develop --profile /nix/var/nix/profiles/devshell --command true\u0026#34; enter = \u0026#34;[ -f flake.nix ] \u0026amp;\u0026amp; exec nix develop --profile /nix/var/nix/profiles/devshell --command\u0026#34; [envs] NIX_CONFIG = \u0026#34;extra-experimental-features = nix-command flakes\u0026#34; NIXPKGS_ALLOW_UNFREE = \u0026#34;1\u0026#34;Step 2: Configure (Optional)# Edit .alca.toml to customize your setup. For example, add resource limits:\n[resources] memory = \u0026#34;8g\u0026#34; cpus = 4Or hide sensitive files from the agent:\n# Shorthand: exclude from workdir mount workdir_exclude = [\u0026#34;**/.env\u0026#34;, \u0026#34;**/.env.*\u0026#34;, \u0026#34;**/secrets/\u0026#34;] # Or use extended mount format for any mount [[mounts]] source = \u0026#34;~/.config/myapp\u0026#34; target = \u0026#34;/root/.config/myapp\u0026#34; exclude = [\u0026#34;**/*.key\u0026#34;, \u0026#34;**/credentials.json\u0026#34;]Excluded files are invisible inside the container.\nCommon configuration options:\nField Description image Container image to use workdir Working directory inside container runtime auto or docker commands.up Setup command run on alca up commands.enter Shell setup command for alca run resources.memory Memory limit (e.g., 4g, 512m) resources.cpus CPU limit (e.g., 4) Step 3: Start the Container# alca upOutput:\n→ Loading config from .alca.toml → Detecting runtime... → Detected runtime: docker → Created new state file: .alca.state.json ✓ Environment readyStep 4: Run Commands# Execute commands inside the container:\nalca run ls -la alca run make build alca run npm testYour project directory is mounted at /workspace by default.\nStep 5: Check Status# alca statusOutput:\nStatus: Initialized Config: /path/to/my-project/.alca.toml Runtime: docker Project ID: my-project-abc123 Container: Running ID: container-id Name: alca-my-project Image: nixos/nix Started: 2024-01-15 10:30:00 Run \u0026#39;alca run \u0026lt;command\u0026gt;\u0026#39; to execute commands.Step 6: Run Your Agent# Run your AI code agent inside the isolated environment:\n# Claude Code with full permissions — safe inside the container alca run claude --dangerously-skip-permissions # Or any other agent alca run codex alca run geminiYour agent has full access inside the container but cannot affect your host system.\nStep 7: Stop the Container# alca downOutput:\nUsing runtime: docker Container stopped successfully.Nix Workflow# Alcatraz does not have built-in Nix or flake integration. Instead, the Nix preset from alca init generates a .alca.toml that configures Nix workflows through standard container commands.\nHow It Works# The Nix preset configures two commands:\ncommands.up — runs on alca up, pre-builds the flake devshell so subsequent enters are fast commands.enter — runs on alca run, drops into nix develop if a flake.nix is present Both use a shell conditional ([ -f flake.nix ] \u0026amp;\u0026amp; ...), so they are no-ops if your project doesn\u0026rsquo;t have a flake.\nExample# If your project has a flake.nix with Go and Node.js in its devshell:\nalca up # Pre-builds the Nix devshell alca run go version # Uses Go from your flake alca run node --version # Uses Node.js from your flakeCustomizing# The preset is just a starting point. You can edit commands.up and commands.enter in .alca.toml to suit your workflow — for example, removing the flake conditional if you always use Nix, or switching to a different base image.\nConfiguration Drift Detection# Alcatraz tracks configuration changes and warns when the running container doesn\u0026rsquo;t match your config.\n# After modifying .alca.toml alca statusOutput:\n⚠️ Configuration drift detected: Image: nixos/nix → ubuntu:latest Resources.memory: 4g → 8g Run \u0026#39;alca up -f\u0026#39; to rebuild with new configuration.To apply changes:\nalca up -f # Force rebuildOr during normal alca up, you\u0026rsquo;ll be prompted:\nConfiguration has changed since last container creation: Image: nixos/nix → ubuntu:latest Rebuild container with new configuration? [y/N]Next Steps# See alca --help for all available commands Check alca \u0026lt;command\u0026gt; --help for command-specific options Review the Configuration Reference for all options If using workdir_exclude or mounts.exclude, see Sync Conflicts for conflict detection and resolution "},{"id":1,"href":"/alcatraz/config/","title":"Configuration","section":"Alcatraz Documentation","content":"Configuration Reference# Configure your agent\u0026rsquo;s isolated environment. Each setting controls what the container can access — from filesystem mounts to network rules — so you stay in control while your agent works freely.\nOverview# Alcatraz uses TOML format for configuration. The configuration file should be named .alca.toml and placed in your project root.\nField Reference# Field Type Required Default Description extends array No [] Config files to extend (declaring file wins) includes array No [] Config files to include (included files win) image string Yes - Container image to use workdir string No \u0026quot;/workspace\u0026quot; Working directory inside container workdir_exclude array No [] Patterns to exclude from workdir mount runtime string No \u0026quot;auto\u0026quot; Runtime selection mode commands.up string or object No - Setup command (run once on container creation) commands.enter string or object No \u0026quot;[ -f flake.nix ] \u0026amp;\u0026amp; exec nix develop\u0026quot; Entry command (run on each shell entry) mounts array No [] Additional mount points resources.memory string No - Memory limit (e.g., \u0026ldquo;4g\u0026rdquo;, \u0026ldquo;512m\u0026rdquo;) resources.cpus int No - CPU limit (e.g., 2, 4) envs table No See below Environment variables for the container network.lan-access array No [] LAN access configuration caps array/table No See below Container Linux capabilities configuration Full Example# # Container image image = \u0026#34;nixos/nix\u0026#34; # Working directory inside container workdir = \u0026#34;/workspace\u0026#34; # Runtime selection: auto, docker, or podman runtime = \u0026#34;auto\u0026#34; # Lifecycle commands [commands] up = \u0026#34;nix-channel --update\u0026#34; enter = \u0026#34;[ -f flake.nix ] \u0026amp;\u0026amp; exec nix develop\u0026#34; # Additional mounts mounts = [ \u0026#34;~/.gitconfig:/root/.gitconfig:ro\u0026#34;, \u0026#34;~/.ssh:/root/.ssh:ro\u0026#34; ] # Resource limits [resources] memory = \u0026#34;16g\u0026#34; cpus = 8 # Environment variables [envs] NIXPKGS_ALLOW_UNFREE = \u0026#34;1\u0026#34; EDITOR = { value = \u0026#34;${EDITOR}\u0026#34;, override_on_enter = true } # Network configuration [network] # lan-access = [\u0026#34;*\u0026#34;] # Uncomment to allow LAN access (blocked by default)"},{"id":2,"href":"/alcatraz/config/extends-includes/","title":"Extends \u0026 Includes","section":"Configuration","content":"Extends \u0026amp; Includes# Configuration files can compose with other files using two directives that control merge direction:\nextends — \u0026ldquo;I inherit from these files; I override them\u0026rdquo; includes — \u0026ldquo;I pull in these files; they override me\u0026rdquo; Extends# The declaring file is the overlay — its values win over extended files.\n# .alca.toml - extends a base (my values win) extends = [\u0026#34;.alca.base.toml\u0026#34;] image = \u0026#34;myapp:latest\u0026#34; # Overrides base image# .alca.base.toml - shared base config image = \u0026#34;nixos/nix\u0026#34; workdir = \u0026#34;/workspace\u0026#34; [commands] enter = \u0026#34;[ -f flake.nix ] \u0026amp;\u0026amp; exec nix develop\u0026#34;Use case: specialization files that build on a shared base.\nIncludes# Included files are the overlay — their values win over the declaring file.\n# .alca.toml - includes local overrides (included files win) includes = [\u0026#34;.alca.local.toml\u0026#34;] image = \u0026#34;nixos/nix\u0026#34;# .alca.local.toml - personal overrides (gitignored) image = \u0026#34;myapp:dev\u0026#34; # Wins over .alca.tomlUse case: the conventional pattern where .local files override the main config.\nThree-Layer Merge# When both directives are present, merge follows three layers:\nextends files (base) \u0026gt; self (middle) \u0026gt; includes files (top)# .alca.toml extends = [\u0026#34;.alca.base.toml\u0026#34;] includes = [\u0026#34;.alca.local.toml\u0026#34;] image = \u0026#34;myapp:latest\u0026#34; Start with .alca.base.toml (base layer) Merge .alca.toml values on top (middle layer — overrides extends) Merge .alca.local.toml values on top (top layer — overrides everything) Path Resolution# Paths are resolved relative to the declaring file\u0026rsquo;s directory (not the current working directory) Absolute paths are also supported Glob Patterns# Use glob patterns to match multiple files:\nincludes = [\u0026#34;.alca.*.toml\u0026#34;] # Includes .alca.dev.toml, .alca.local.toml, etc. Supported patterns: *, ?, [...] Empty glob results are OK (no error if no files match) Literal paths (without glob characters) must exist or will error Merge Behavior# Type Behavior Objects Deep merge (nested fields merged recursively) Arrays Append (concatenate, no deduplication) Same key Overlay value wins Processing Order# Both directives process their arrays left-to-right, depth-first. Each referenced file is recursively resolved (its own extends/includes processed) before participating in the merge.\nWithin-array priority differs by directive:\nextends = [B, C, D]: left overrides right — B \u0026gt; C \u0026gt; D (like OOP: first parent has highest priority) includes = [B, C, D]: right overrides left — D \u0026gt; C \u0026gt; B (like CSS: last entry wins) Processing a file with both directives:\n// 1. Resolve extends (self is overlay, first entry has highest priority among extends) result = extends[last] for i in (last-1)..0: result = merge(base=result, overlay=extends[i]) result = merge(base=result, overlay=self) // 2. Resolve includes (included files are overlay, last entry has highest priority) for each inc in includes: result = merge(base=result, overlay=inc)Example — extends: A extends [B, C]\ntemp = merge(base=C, overlay=B) // B \u0026gt; C final = merge(base=temp, overlay=A) // A \u0026gt; B \u0026gt; C Priority (low→high): C \u0026lt; B \u0026lt; AExample — includes: A includes [B, C]\ntemp = merge(base=A, overlay=B) // B \u0026gt; A final = merge(base=temp, overlay=C) // C \u0026gt; B \u0026gt; A Priority (low→high): A \u0026lt; B \u0026lt; CError Handling# Circular reference: Error with clear message File not found (literal path): Error Empty glob result: OK (continues without including anything) Example: Environment-specific Configuration# # .alca.toml extends = [\u0026#34;.alca.base.toml\u0026#34;] includes = [\u0026#34;.alca.local.toml\u0026#34;] # .alca.local.toml is gitignored for machine-specific overrides # .alca.base.toml (checked into repo) image = \u0026#34;nixos/nix\u0026#34; workdir = \u0026#34;/workspace\u0026#34; mounts = [\u0026#34;~/.gitconfig:/root/.gitconfig:ro\u0026#34;] # .alca.local.toml (gitignored, wins over everything) mounts = [\u0026#34;/my/local/cache:/cache\u0026#34;] [resources] memory = \u0026#34;32g\u0026#34; cpus = 16See AGD-033 for design rationale.\n"},{"id":3,"href":"/alcatraz/config/fields/","title":"Field Reference","section":"Configuration","content":"Field Reference# image# The container image to use for the isolated environment.\nimage = \u0026#34;nixos/nix\u0026#34; Type: string Required: Yes Default: None (must be specified) Examples: \u0026quot;ubuntu:22.04\u0026quot;, \u0026quot;alpine:latest\u0026quot;, \u0026quot;nixos/nix\u0026quot; workdir# The working directory inside the container where your project will be mounted.\nworkdir = \u0026#34;/workspace\u0026#34; Type: string Required: No Default: \u0026quot;/workspace\u0026quot; Notes: Must be an absolute path workdir_exclude# Patterns to exclude from the workdir mount. When specified, Alcatraz uses Mutagen for file synchronization instead of direct bind mounts.\nworkdir = \u0026#34;/workspace\u0026#34; workdir_exclude = [\u0026#34;node_modules\u0026#34;, \u0026#34;.git\u0026#34;, \u0026#34;dist\u0026#34;] Type: array of strings Required: No Default: [] Notes: Patterns follow gitignore-like syntax (see Exclude Patterns) This is a convenience shorthand for configuring excludes on the workdir mount. The following configurations are equivalent:\n# Using workdir_exclude (recommended) workdir = \u0026#34;/workspace\u0026#34; workdir_exclude = [\u0026#34;node_modules\u0026#34;, \u0026#34;.git\u0026#34;]# Using extended mount format workdir = \u0026#34;/workspace\u0026#34; [[mounts]] source = \u0026#34;.\u0026#34; target = \u0026#34;/workspace\u0026#34; exclude = [\u0026#34;node_modules\u0026#34;, \u0026#34;.git\u0026#34;]Note: You cannot add a mount targeting the same path as workdir. If you need to exclude subdirectories from syncing, use workdir_exclude instead of creating a separate mount.\nWhen using workdir_exclude, Alcatraz monitors for sync conflicts (simultaneous edits on both sides). See Sync Conflicts for detection and resolution.\nruntime# Selects which container runtime to use.\nruntime = \u0026#34;auto\u0026#34; Type: string Required: No Default: \u0026quot;auto\u0026quot; Valid values: \u0026quot;auto\u0026quot; - Auto-detect best available runtime (Linux: Podman \u0026gt; Docker; macOS: Docker / OrbStack) \u0026quot;docker\u0026quot; - Force Docker regardless of other available runtimes commands.up# Setup command executed once when the container is created. Use this for one-time initialization tasks.\n[commands] up = \u0026#34;nix-channel --update \u0026amp;\u0026amp; nix-env -iA nixpkgs.git\u0026#34; Type: string or object Required: No Default: None Examples: \u0026quot;apt-get update \u0026amp;\u0026amp; apt-get install -y vim\u0026quot; \u0026quot;nix-channel --update\u0026quot; commands.enter# Entry command executed each time you enter the container shell. Use this for environment setup.\n[commands] enter = \u0026#34;[ -f flake.nix ] \u0026amp;\u0026amp; exec nix develop\u0026#34; Type: string or object Required: No Default: \u0026quot;[ -f flake.nix ] \u0026amp;\u0026amp; exec nix develop\u0026quot; Notes: If the command uses exec, it replaces the shell process Command Formats# Commands support both a simple string format and a struct format with merge control.\nString Format# [commands] up = \u0026#34;docker compose up -d\u0026#34;Struct Format# [commands.up] command = \u0026#34;docker compose up -d\u0026#34; append = false Field Type Required Default Description command string Yes - The command string append bool No false Append to base command during config merge Both formats are equivalent when append is not needed.\nCommand Append# The append flag controls how a command merges with its base during config layering (via extends or includes):\nappend = false (default): overlay replaces the base command entirely append = true: result is base_command + \u0026quot; \u0026quot; + overlay_command (space-concatenated) Only the overlay\u0026rsquo;s append flag is consulted. The base\u0026rsquo;s append value is ignored during merge.\n# .alca.toml includes = [\u0026#34;.alca.local.toml\u0026#34;] [commands.up] command = \u0026#34;nix develop\u0026#34; # .alca.local.toml (overlay via includes) [commands.up] command = \u0026#34;bash\u0026#34; append = true # Result: \u0026#34;nix develop bash\u0026#34;See AGD-034 for design rationale.\nmounts# Additional mount points beyond the default project mount. Supports both simple string format and extended object format with exclude patterns.\nSimple String Format# mounts = [ \u0026#34;/path/on/host:/path/in/container\u0026#34;, \u0026#34;~/.ssh:/root/.ssh:ro\u0026#34; ] Format: \u0026quot;host_path:container_path\u0026quot; or \u0026quot;host_path:container_path:ro\u0026quot; Options: ro (read-only) Extended Object Format# Use the extended format when you need to exclude files from being visible inside the container. See AGD-025 for design rationale.\n[[mounts]] source = \u0026#34;/Users/me/project\u0026#34; target = \u0026#34;/workspace\u0026#34; readonly = false exclude = [ \u0026#34;**/.env.prod\u0026#34;, \u0026#34;**/.env.local\u0026#34;, \u0026#34;**/secrets/\u0026#34;, \u0026#34;**/*.key\u0026#34;, ] Field Type Required Default Description source string Yes - Host path target string Yes - Container path readonly bool No false Read-only mount exclude array No [] Glob patterns to exclude Exclude Patterns# Exclude patterns follow gitignore-like syntax (Mutagen ignore format):\nPattern Matches **/ Any directory depth *.ext Files with extension dir/ Directory (trailing slash) **/.env .env file at any depth **/secrets/ secrets/ directory at any depth Security: hide sensitive files from your agent:\n[[mounts]] source = \u0026#34;.\u0026#34; target = \u0026#34;/workspace\u0026#34; exclude = [ \u0026#34;**/.env\u0026#34;, # Environment secrets \u0026#34;**/.env.*\u0026#34;, # Environment variants \u0026#34;**/secrets/\u0026#34;, # Secret directories \u0026#34;**/*.key\u0026#34;, # Private keys \u0026#34;**/*.pem\u0026#34;, # Certificates ]Excluded files are invisible inside the container — even with full agent access within the sandbox.\nRecommended excludes for Node.js projects:\n[[mounts]] source = \u0026#34;.\u0026#34; target = \u0026#34;/workspace\u0026#34; exclude = [ \u0026#34;node_modules/\u0026#34;, # Container runs its own npm install \u0026#34;.pnpm-store/\u0026#34;, # pnpm cache \u0026#34;dist/\u0026#34;, # Build output \u0026#34;.next/\u0026#34;, # Next.js cache ]Note: When excludes are specified, Alcatraz uses Mutagen for file synchronization instead of direct bind mounts. This provides file filtering but introduces 50-200ms sync latency.\nType: array (strings or objects) Required: No Default: [] resources.memory# Memory limit for the container.\n[resources] memory = \u0026#34;4g\u0026#34; Type: string Required: No Default: None (no limit, uses runtime default) Format: Number followed by suffix Suffixes: b (bytes), k (KB), m (MB), g (GB) Examples: \u0026quot;512m\u0026quot;, \u0026quot;2g\u0026quot;, \u0026quot;16g\u0026quot; resources.cpus# CPU limit for the container.\n[resources] cpus = 4 Type: integer Required: No Default: None (no limit, uses runtime default) Examples: 1, 2, 4, 8 envs# Environment variables for the container. See AGD-017 for design rationale.\n[envs] # Static value - set at container creation NIXPKGS_ALLOW_UNFREE = \u0026#34;1\u0026#34; # Read from host environment at container creation MY_TOKEN = \u0026#34;${MY_TOKEN}\u0026#34; # Read from host and refresh on each `alca run` EDITOR = { value = \u0026#34;${EDITOR}\u0026#34;, override_on_enter = true } Type: table (key-value pairs) Required: No Value formats: \u0026quot;string\u0026quot; - Static value or ${VAR} reference, set at container creation { value = \u0026quot;...\u0026quot;, override_on_enter = true } - Also refresh on each alca run Variable Expansion# Use ${VAR} to read from host environment. Only simple syntax is supported:\n[envs] # Valid TERM = \u0026#34;${TERM}\u0026#34; MY_VAR = \u0026#34;${MY_CUSTOM_VAR}\u0026#34; # Invalid - will error GREETING = \u0026#34;hello${NAME}\u0026#34; # Complex interpolation not supportedDefault Environment Variables# The following are passed by default with override_on_enter = true:\nVariable Description TERM Terminal type COLORTERM Color terminal capability LANG Default locale LC_ALL Override all locale settings LC_COLLATE Collation order LC_CTYPE Character classification LC_MESSAGES Message language LC_MONETARY Monetary formatting LC_NUMERIC Numeric formatting LC_TIME Date/time formatting User-defined values override these defaults.\ncaps# Linux capabilities configuration for container security. See AGD-026 for design rationale.\nSecurity rationale: Docker\u0026rsquo;s default capabilities include dangerous ones like NET_RAW (network sniffing) and MKNOD (device creation) that AI code agents don\u0026rsquo;t need. Alcatraz drops all capabilities by default and only adds the minimal set needed for development workflows, keeping your agent sandboxed with least-privilege access.\nDefault Behavior (No caps field)# # No caps field - secure defaults applied image = \u0026#34;nixos/nix\u0026#34;Result: --cap-drop ALL --cap-add CHOWN --cap-add DAC_OVERRIDE --cap-add FOWNER --cap-add KILL --cap-add SETUID --cap-add SETGID\nDefault capabilities:\nCHOWN: Package managers (npm, pip, cargo) need to modify file ownership DAC_OVERRIDE: Bypass file read/write/execute permission checks for file operations in containers FOWNER: Modify file permissions and attributes during builds KILL: Terminate child processes (test runners, dev servers) SETUID: Required by package managers (apt, nix) for sandbox/daemon builds SETGID: Required by package managers (apt, nix) for sandbox/daemon builds Mode 1: Additive (Array)# Add capabilities beyond the defaults:\ncaps = [\u0026#34;NET_BIND_SERVICE\u0026#34;]Result: --cap-drop ALL --cap-add CHOWN --cap-add DAC_OVERRIDE --cap-add FOWNER --cap-add KILL --cap-add SETUID --cap-add SETGID --cap-add NET_BIND_SERVICE\nUse this when you need additional capabilities but want to keep the secure default base.\nMode 2: Full Control (Object)# Take complete control over capabilities:\n[caps] drop = [\u0026#34;NET_RAW\u0026#34;, \u0026#34;MKNOD\u0026#34;, \u0026#34;AUDIT_WRITE\u0026#34;] add = [\u0026#34;CHOWN\u0026#34;, \u0026#34;FOWNER\u0026#34;, \u0026#34;KILL\u0026#34;, \u0026#34;SETUID\u0026#34;, \u0026#34;SETGID\u0026#34;]Result: --cap-drop NET_RAW --cap-drop MKNOD --cap-drop AUDIT_WRITE --cap-add CHOWN --cap-add FOWNER --cap-add KILL --cap-add SETUID --cap-add SETGID\nUse this when you want explicit control. No implicit defaults are applied in this mode.\nExample: Keep Docker Defaults, Drop Dangerous Ones# [caps] drop = [\u0026#34;NET_RAW\u0026#34;, \u0026#34;MKNOD\u0026#34;, \u0026#34;SYS_CHROOT\u0026#34;] # No add field - keeps Docker defaults minus dropped onesResult: --cap-drop NET_RAW --cap-drop MKNOD --cap-drop SYS_CHROOT\nTroubleshooting# Error Solution Permission denied when writing files Add DAC_OVERRIDE capability Operation not permitted with setuid Ensure SETUID and SETGID are in add list (included by default) Package manager fails to change ownership Ensure CHOWN and FOWNER are in add list extends# Extend other configuration files. The declaring file overrides extended files.\nextends = [\u0026#34;.alca.base.toml\u0026#34;] Type: array of strings Required: No Default: [] Notes: Paths are resolved relative to the declaring file\u0026rsquo;s directory. Supports glob patterns (*.toml). The declaring file\u0026rsquo;s values win over extended files. includes# Include other configuration files. Included files override the declaring file.\nincludes = [\u0026#34;.alca.local.toml\u0026#34;] Type: array of strings Required: No Default: [] Notes: Paths are resolved relative to the declaring file\u0026rsquo;s directory. Supports glob patterns (*.toml). Included files\u0026rsquo; values win over the declaring file. See Extends \u0026amp; Includes for full documentation including three-layer merge, processing order, and migration guide.\nnetwork.lan-access# Control container access to your local network (LAN).\n[network] lan-access = [\u0026#34;*\u0026#34;] Type: array of strings Required: No Default: [] (no LAN access — containers can reach the internet but not local machines) Valid values: \u0026quot;*\u0026quot; (allow all LAN access) See Network Configuration for platform behavior, the network helper, and why nftables inside the VM is necessary on macOS.\nRuntime-Specific Notes# Docker / Podman# Resource limits are passed as container-level flags:\nMemory: -m or --memory flag CPU: --cpus flag Important: On macOS, Docker Desktop runs containers in a VM with fixed resource allocation. Container limits are constrained by the VM\u0026rsquo;s allocated resources. Configure VM resources via Docker Desktop \u0026gt; Settings \u0026gt; Resources. (OrbStack manages resources automatically — no manual configuration needed.)\nmacOS Users: We recommend OrbStack as it provides automatic memory management (shrinking unused memory), which colima and lima do not support.\n"},{"id":4,"href":"/alcatraz/config/network/","title":"Network Configuration","section":"Configuration","content":"Network Configuration# By default, Alcatraz containers can access the internet but cannot access your local network (LAN). This prevents AI agents from reaching local services, databases, or other machines on your network.\nQuick Summary# Scenario Internet LAN Config needed Default (no config) Yes No None Allow specific LAN access Yes Configured hosts lan-access = [...] Allow all LAN access Yes Yes lan-access = [\u0026quot;*\u0026quot;] Why nftables Inside the VM?# On macOS, both Docker Desktop and OrbStack run containers inside a Linux VM. Container network traffic does not pass through macOS kernel network interfaces — instead it is handled entirely in userspace:\nDocker Desktop uses vpnkit, a userspace TCP/IP stack that reads raw ethernet frames from the VM over a shared-memory channel and translates them into regular macOS socket calls via the com.docker.backend process. Docker\u0026rsquo;s security documentation explicitly describes this as \u0026ldquo;a user-space process (com.docker.vpnkit) for network connectivity instead of kernel-level networking.\u0026rdquo; OrbStack uses a custom-built virtual network stack that is \u0026ldquo;purpose-built from scratch.\u0026rdquo; The 45 Gbps throughput between macOS and Linux confirms shared-memory transport rather than kernel network interfaces. Since macOS pf (packet filter) operates on kernel network interfaces, it cannot intercept container traffic on either platform. Docker\u0026rsquo;s own documentation recommends applying process-level firewall rules to com.docker.backend instead, but this only provides coarse-grained control (all containers or none). Per-container firewall rules must be applied inside the Linux VM using nftables, which is exactly what Alcatraz does automatically.\nOn Linux, containers run natively, and Alcatraz uses the system\u0026rsquo;s native nftables directly.\nnetwork.lan-access# Allow containers to access LAN hosts.\n[network] lan-access = [\u0026#34;*\u0026#34;] Type: array of strings Required: No Default: [] (no LAN access) Valid values: \u0026quot;*\u0026quot; (allow all LAN access) Platform Behavior# Both macOS and Linux use nftables for network isolation and LAN access rules.\nPlatform Runtime Mechanism Helper macOS OrbStack nftables via vmhelper container (nsenter into VM) alcatraz-network-helper Docker container macOS Docker Desktop nftables via vmhelper container (nsenter into VM) alcatraz-network-helper Docker container Linux Docker/Podman Native nftables Include in /etc/nftables.conf Network Helper# The network helper manages nftables firewall rules for container network isolation. It works on both macOS and Linux, with platform-specific implementations.\nCommands# # Install (requires sudo on Linux) alca network-helper install # Check status alca network-helper status # Uninstall alca network-helper uninstallAutomatic Installation# When running alca up with lan-access configured (or when network isolation is needed), Alcatraz checks if the network helper is installed. If not, it offers to install it automatically:\nNetwork helper required for LAN access. Install now? [y/N]macOS: vmhelper Container# On macOS, containers run inside a Linux VM managed by OrbStack or Docker Desktop. Alcatraz cannot use macOS-level firewalls (like pf) because container traffic is handled in userspace and never passes through the macOS kernel\u0026rsquo;s network stack.\nInstead, Alcatraz runs a helper container (alcatraz-network-helper) that applies nftables rules inside the VM using nsenter:\nRule files (.nft) are written to ~/.alcatraz/files/alcatraz_nft/ The helper container mounts ~/.alcatraz/files/ and watches for changes Rules are loaded via nsenter -t 1 -m -u -n -i sh -c 'nft -f /dev/stdin' \u0026lt; \u0026quot;$f\u0026quot; to cross mount namespace boundaries The helper also responds to SIGHUP for on-demand reloads Install creates:\n~/.alcatraz/files/alcatraz_nft/ directory for rule files ~/.alcatraz/files/alcatraz_network_helper/entry.sh script alcatraz-network-helper Docker container (privileged, --pid=host, --net=host, --restart=always) Uninstall removes the alcatraz-network-helper container.\nLinux: Native nftables# On Linux, Alcatraz uses the system\u0026rsquo;s native nftables directly.\nInstall creates:\n/etc/nftables.d/alcatraz/ directory for rule files Include line in /etc/nftables.conf: include \u0026quot;/etc/nftables.d/alcatraz/*.nft\u0026quot; Enables and reloads nftables.service Uninstall removes:\nAll rule files from /etc/nftables.d/alcatraz/ The include line from /etc/nftables.conf All alca-* nftables tables The /etc/nftables.d/alcatraz/ directory How It Works# On alca up, if lan-access is configured or network isolation is needed:\nChecks if the network helper is installed; offers to install if not Writes per-container nftables rule files Loads rules via the platform-specific mechanism On alca down:\nRemoves per-container rule files Cleans up container-specific nftables tables For design rationale, see AGD-030.\nWithout Alcatraz# For context, here\u0026rsquo;s what manual LAN isolation requires on macOS:\nRun a privileged container or use nsenter to access the Docker Desktop / OrbStack VM\u0026rsquo;s network namespace Write nftables or iptables rules blocking traffic to private IP ranges (10.0.0.0/8, 172.16.0.0/12, 192.168.0.0/16) Handle rule persistence — rules are lost on VM restart and must be reapplied Manage per-container rule lifecycle (create on start, clean up on stop) Alcatraz automates all of this through the network helper.\nManual Cleanup# If Alcatraz is broken, you can clean up manually:\nmacOS# # View running helper container docker inspect alcatraz-network-helper # Remove helper container docker rm -f alcatraz-network-helper # View active nftables rules inside the VM (OrbStack) docker run --rm --privileged --pid=host alpine nsenter -t 1 -m -u -n -i nft list tables # Delete all alcatraz nftables tables inside the VM docker run --rm --privileged --pid=host alpine sh -c \u0026#39; nsenter -t 1 -m -u -n -i nft list tables | grep \u0026#34;inet alca-\u0026#34; | while read _ _ table; do nsenter -t 1 -m -u -n -i nft delete table inet \u0026#34;$table\u0026#34; done \u0026#39; # Remove rule files rm -rf ~/.alcatraz/files/alcatraz_nft/ rm -rf ~/.alcatraz/files/alcatraz_network_helper/Linux# # View active alcatraz nftables tables sudo nft list tables | grep alca- # Delete all alcatraz tables sudo nft list tables | grep \u0026#34;inet alca-\u0026#34; | while read _ _ table; do sudo nft delete table inet \u0026#34;$table\u0026#34; done # Remove rule files and directory sudo rm -rf /etc/nftables.d/alcatraz/ # Remove include line from nftables.conf (edit manually) sudo vi /etc/nftables.conf # Remove the line: include \u0026#34;/etc/nftables.d/alcatraz/*.nft\u0026#34; # Reload nftables sudo nft -f /etc/nftables.conf"},{"id":5,"href":"/alcatraz/runtimes/","title":"Runtimes","section":"Alcatraz Documentation","content":"Runtimes# Alcatraz supports multiple container runtimes for isolating code execution. This document covers the supported runtimes, their characteristics, and how to configure them.\nRuntime Overview# Auto-Detection# By default (runtime = \u0026quot;auto\u0026quot;), Alcatraz automatically selects the best available runtime:\nPlatform Priority Order Linux Podman \u0026gt; Docker Other Docker macOS Users: We recommend OrbStack as it provides automatic memory management (shrinking unused memory), which colima and lima do not support.\nManual Selection# Override auto-detection by setting runtime in .alca.toml:\nruntime = \u0026#34;docker\u0026#34; # Force Docker runtime = \u0026#34;auto\u0026#34; # Auto-detect (default)Docker# Docker is the most widely supported runtime, available on macOS, Linux, and Windows.\nAvailability# Alcatraz checks for Docker availability by running:\ndocker version --format \u0026#39;{{.Server.Version}}\u0026#39;macOS Behavior# On macOS, Docker runs containers inside a Linux VM (Docker Desktop or OrbStack):\nVM Model: Single shared VM for all containers Memory: Must be pre-allocated to the VM via Docker Desktop settings (OrbStack manages memory automatically) Memory Release: Docker Desktop does not release unused memory back to macOS; OrbStack shrinks unused memory automatically Resource Limits: Container limits (-m, --cpus) constrained by VM allocation To configure VM resources (Docker Desktop only; not needed for OrbStack):\nDocker Desktop \u0026gt; Settings \u0026gt; Resources \u0026gt; Advanced Or edit ~/.docker/daemon.json Linux Behavior# On Linux, Docker runs containers natively:\nVM Model: None (native kernel) Memory: Allocated on-demand from host Memory Release: Automatic, managed by cgroups Resource Limits: Direct cgroups control, no VM constraint Resource Limits# # Via alca.toml [resources] memory = \u0026#34;4g\u0026#34; cpus = 4 # Translates to: docker run -m 4g --cpus 4 ...Troubleshooting# Issue Solution \u0026ldquo;Docker not found\u0026rdquo; Install Docker Desktop, OrbStack, or Docker Engine \u0026ldquo;Cannot connect to Docker daemon\u0026rdquo; Start Docker Desktop / OrbStack or sudo systemctl start docker Container slow / memory issues Increase Docker Desktop VM memory (OrbStack manages this automatically) OrbStack# OrbStack is the recommended runtime on macOS. It provides its own docker CLI, so Alcatraz detects and uses it the same way as Docker — no additional configuration needed.\nOrbStack offers automatic memory management (shrinks unused memory), unlike Docker Desktop which requires manual pre-allocation.\nPodman# Podman is preferred on Linux for its rootless container support.\nAvailability# Alcatraz checks for Podman availability by running:\npodman version --format \u0026#39;{{.Version}}\u0026#39;macOS# Podman is not supported on macOS. Use Docker (we recommend OrbStack) instead.\nLinux Behavior# On Linux, Podman runs natively with rootless support:\nVM Model: None (native kernel) Memory: Direct cgroups control Rootless: Can run containers without root privileges Resource Limits# # Via alca.toml (same as Docker) [resources] memory = \u0026#34;4g\u0026#34; cpus = 4 # Translates to: podman run -m 4g --cpus 4 ...Troubleshooting# Issue Solution \u0026ldquo;Podman not found\u0026rdquo; Install via package manager (apt install podman) Comparison Table# Feature Docker (macOS) Docker (Linux) Podman (Linux) VM Model Single shared VM None (native) None (native) Idle Memory 3-4 GB ~0 ~0 Memory Release Manual Automatic Automatic Resource Isolation Shared VM Native cgroups Native cgroups Host Config Needed Yes (VM settings) No No Per-container Limits Yes (-m, --cpus) Yes (-m, --cpus) Yes (-m, --cpus) Live Update docker update docker update Limited Rootless No Optional Yes (default) Platform macOS, Linux, Windows Linux Linux Verifying Runtime Selection# Check which runtime Alcatraz is using:\n# Show detected runtime alca statusThe status output indicates the active runtime.\nReferences# Docker Resource Constraints Docker Desktop Settings OrbStack — Recommended Docker runtime for macOS "},{"id":6,"href":"/alcatraz/sync-conflicts/","title":"Sync Conflicts","section":"Alcatraz Documentation","content":"Sync Conflicts# Overview# Sync conflicts occur when the same file is modified on both your local machine and inside the container simultaneously. Alcatraz detects these conflicts automatically and provides tools to resolve them.\nDetection# Conflict detection runs automatically in the background. Results are cached in .alca/sync-conflicts-cache.json within your project directory using a stale-while-revalidate (SWR) pattern:\nStale read: Commands like alca up, alca run, and alca down read from the cache for instant display, then refresh the cache asynchronously in the background. Fresh read: alca status and alca experimental sync check perform a synchronous fresh check. The .alca/ directory is auto-created when needed and should be added to .gitignore.\nNotification# When sync conflicts exist, a warning banner is displayed:\nalca up, alca run, alca down: Banner is shown on stderr (does not interfere with command output) alca status: Conflict banner is shown on stderr after the status display If conflict detection fails (e.g., mutagen daemon not running), a warning is printed to stderr instead of failing silently.\nThe banner shows up to 3 conflicting file paths with descriptions of each side\u0026rsquo;s state (e.g., \u0026ldquo;modified locally, deleted in container\u0026rdquo;), plus a count of additional conflicts if more than 3 exist.\nResolution# Interactive Resolution# Use alca experimental sync resolve to walk through conflicts one by one:\n$ alca experimental sync resolve 2 sync conflicts found: [1/2] src/main.go Local (your machine): modified Container: modified ? How to resolve? \u0026gt; Local overwrites container Container overwrites local SkipFor each conflict, choose one of:\nLocal overwrites container — Your local file replaces the container version Container overwrites local — The container file replaces your local version Skip — Leave the conflict unresolved The container must be running for resolution to work.\nMachine-Readable Check# Use alca experimental sync check for scripting:\nif ! alca experimental sync check; then echo \u0026#34;Sync conflicts detected\u0026#34; alca experimental sync resolve fiExit codes: 0 = no conflicts, 1 = conflicts found.\nCustom Output with --template# The --template flag accepts a Go text/template string, giving you full control over the output format.\nTemplate data:\nThe root object has the following fields:\nField Type Description .Count int Number of conflicts .Conflicts []ConflictInfo List of conflict details Each ConflictInfo in .Conflicts has:\nField Type Description .Path string Relative file path from project root .LocalState string State on your machine: modified, created, deleted, directory .ContainerState string State in the container: modified, created, deleted, directory .DetectedAt time.Time When the conflict was first detected A built-in json helper function is available for JSON serialization.\nExamples:\n# JSON output (for parsing by other tools) alca experimental sync check --template=\u0026#39;{{ json . }}\u0026#39; # Count only alca experimental sync check --template=\u0026#39;{{ .Count }} conflicts\u0026#39; # List conflicting paths, one per line alca experimental sync check --template=\u0026#39;{{ range .Conflicts }}{{ .Path }}{{ \u0026#34;\\n\u0026#34; }}{{ end }}\u0026#39; # Show path and state details alca experimental sync check --template=\u0026#39;{{ range .Conflicts }}{{ .Path }}: {{ .LocalState }} vs {{ .ContainerState }}{{ \u0026#34;\\n\u0026#34; }}{{ end }}\u0026#39;When --template is used, the template output is written to stdout. Exit codes remain the same (0 = no conflicts, 1 = conflicts found).\nRelated Commands# alca status — Shows sync conflict information alca experimental sync check — Machine-readable conflict check alca experimental sync resolve — Interactive conflict resolution "},{"id":7,"href":"/alcatraz/commands/alca/","title":"alca","section":"Command Reference","content":"alca# Alcatraz - Run code agents unrestricted, but fearlessly\nSynopsis# Alcatraz (alca) — Run code agents unrestricted, but fearlessly.\nWraps AI code agents in containers with file and network isolation, so you can run agents without guardrails and keep your system safe.\nOptions# -h, --help help for alcaSEE ALSO# alca cleanup\t- Remove orphaned Alcatraz containers alca down\t- Stop the sandbox environment alca experimental\t- Experimental commands (use with caution) alca init\t- Initialize Alcatraz configuration in current directory alca list\t- List all Alcatraz containers alca network-helper\t- Manage network helper for LAN access alca run\t- Run a command inside the sandbox alca status\t- Show current Alcatraz status alca up\t- Start the sandbox environment Auto generated by spf13/cobra on 12-Feb-2026# "},{"id":8,"href":"/alcatraz/commands/alca_cleanup/","title":"alca cleanup","section":"Command Reference","content":"alca cleanup# Remove orphaned Alcatraz containers\nSynopsis# Find and remove orphaned Alcatraz containers.\nAn orphan container is one whose project directory no longer exists, or whose state file (.alca/state.json) has been deleted.\nalca cleanup [flags]Options# --all Delete all orphan containers without prompting -h, --help help for cleanupSEE ALSO# alca\t- Alcatraz - Run code agents unrestricted, but fearlessly Auto generated by spf13/cobra on 12-Feb-2026# "},{"id":9,"href":"/alcatraz/commands/alca_down/","title":"alca down","section":"Command Reference","content":"alca down# Stop the sandbox environment\nSynopsis# Stop the running Alcatraz sandbox environment.\nalca down [flags]Options# --force Skip sync conflict check and proceed anyway -h, --help help for downSEE ALSO# alca\t- Alcatraz - Run code agents unrestricted, but fearlessly Auto generated by spf13/cobra on 12-Feb-2026# "},{"id":10,"href":"/alcatraz/commands/alca_experimental/","title":"alca experimental","section":"Command Reference","content":"alca experimental# Experimental commands (use with caution)\nSynopsis# Experimental commands that may change or be removed in future versions.\nOptions# -h, --help help for experimentalSEE ALSO# alca\t- Alcatraz - Run code agents unrestricted, but fearlessly alca experimental reload\t- Reload sandbox configuration alca experimental sync\t- Sync conflict management Auto generated by spf13/cobra on 12-Feb-2026# "},{"id":11,"href":"/alcatraz/commands/alca_experimental_reload/","title":"alca experimental reload","section":"Command Reference","content":"alca experimental reload# Reload sandbox configuration\nSynopsis# Reload the sandbox configuration without rebuilding from scratch.\nThis command re-applies mounts and configuration by recreating the container with the updated settings. Running processes inside the container will be terminated.\nThis is an experimental feature and its behavior may change in future versions.\nalca experimental reload [flags]Options# -h, --help help for reloadSEE ALSO# alca experimental\t- Experimental commands (use with caution) Auto generated by spf13/cobra on 12-Feb-2026# "},{"id":12,"href":"/alcatraz/commands/alca_experimental_sync/","title":"alca experimental sync","section":"Command Reference","content":"alca experimental sync# Sync conflict management\nOptions# -h, --help help for syncSEE ALSO# alca experimental\t- Experimental commands (use with caution) alca experimental sync check\t- Check for sync conflicts alca experimental sync resolve\t- Resolve sync conflicts interactively Auto generated by spf13/cobra on 12-Feb-2026# "},{"id":13,"href":"/alcatraz/commands/alca_experimental_sync_check/","title":"alca experimental sync check","section":"Command Reference","content":"alca experimental sync check# Check for sync conflicts\nSynopsis# Check for file sync conflicts. Exit 0 if no conflicts, exit 1 if conflicts exist.\nalca experimental sync check [flags]Options# -h, --help help for check --template string Go template for output formatSEE ALSO# alca experimental sync\t- Sync conflict management Auto generated by spf13/cobra on 12-Feb-2026# "},{"id":14,"href":"/alcatraz/commands/alca_experimental_sync_resolve/","title":"alca experimental sync resolve","section":"Command Reference","content":"alca experimental sync resolve# Resolve sync conflicts interactively\nSynopsis# Walk through sync conflicts one by one and choose how to resolve each.\nalca experimental sync resolve [flags]Options# -h, --help help for resolveSEE ALSO# alca experimental sync\t- Sync conflict management Auto generated by spf13/cobra on 12-Feb-2026# "},{"id":15,"href":"/alcatraz/commands/alca_init/","title":"alca init","section":"Command Reference","content":"alca init# Initialize Alcatraz configuration in current directory\nSynopsis# Initialize Alcatraz by creating a .alca.toml configuration file in the current directory with default settings.\nalca init [flags]Options# -h, --help help for initSEE ALSO# alca\t- Alcatraz - Run code agents unrestricted, but fearlessly Auto generated by spf13/cobra on 12-Feb-2026# "},{"id":16,"href":"/alcatraz/commands/alca_list/","title":"alca list","section":"Command Reference","content":"alca list# List all Alcatraz containers\nSynopsis# List all containers managed by Alcatraz across all projects.\nalca list [flags]Options# -h, --help help for listSEE ALSO# alca\t- Alcatraz - Run code agents unrestricted, but fearlessly Auto generated by spf13/cobra on 12-Feb-2026# "},{"id":17,"href":"/alcatraz/commands/alca_network-helper/","title":"alca network-helper","section":"Command Reference","content":"alca network-helper# Manage network helper for LAN access\nSynopsis# Manage the network helper for container LAN access.\nOn macOS: Installs a helper container that runs nftables inside the container runtime VM for network isolation.\nOn Linux: Configures nftables to include alcatraz rule files from /etc/nftables.d/alcatraz/ for persistent firewall rules.\nOptions# -h, --help help for network-helperSEE ALSO# alca\t- Alcatraz - Run code agents unrestricted, but fearlessly alca network-helper install\t- Install the network helper alca network-helper status\t- Show network helper status alca network-helper uninstall\t- Uninstall the network helper Auto generated by spf13/cobra on 12-Feb-2026# "},{"id":18,"href":"/alcatraz/commands/alca_network-helper_install/","title":"alca network-helper install","section":"Command Reference","content":"alca network-helper install# Install the network helper\nSynopsis# Install the network helper for automatic firewall rule management.\nOn macOS:\nCreate ~/.alcatraz/files/alcatraz_nft/ directory Start the alcatraz-network-helper container On Linux:\nCreate /etc/nftables.d/alcatraz/ directory Add include line to /etc/nftables.conf Reload nftables configuration Requires sudo privileges on Linux.\nalca network-helper install [flags]Options# -h, --help help for installSEE ALSO# alca network-helper\t- Manage network helper for LAN access Auto generated by spf13/cobra on 12-Feb-2026# "},{"id":19,"href":"/alcatraz/commands/alca_network-helper_status/","title":"alca network-helper status","section":"Command Reference","content":"alca network-helper status# Show network helper status\nSynopsis# Display the current status of the network helper, including LaunchDaemon state and active rules.\nalca network-helper status [flags]Options# -h, --help help for statusSEE ALSO# alca network-helper\t- Manage network helper for LAN access Auto generated by spf13/cobra on 12-Feb-2026# "},{"id":20,"href":"/alcatraz/commands/alca_network-helper_uninstall/","title":"alca network-helper uninstall","section":"Command Reference","content":"alca network-helper uninstall# Uninstall the network helper\nSynopsis# Uninstall the network helper and clean up all rules.\nOn macOS:\nStop and remove the alcatraz-network-helper container On Linux:\nRemove all rule files from /etc/nftables.d/alcatraz/ Remove include line from /etc/nftables.conf Delete all alca-* nftables tables Remove /etc/nftables.d/alcatraz/ directory Requires sudo privileges on Linux.\nalca network-helper uninstall [flags]Options# -h, --help help for uninstallSEE ALSO# alca network-helper\t- Manage network helper for LAN access Auto generated by spf13/cobra on 12-Feb-2026# "},{"id":21,"href":"/alcatraz/commands/alca_run/","title":"alca run","section":"Command Reference","content":"alca run# Run a command inside the sandbox\nSynopsis# Execute a command inside the Alcatraz sandbox environment.\nalca run [command] [flags]Options# -h, --help help for runSEE ALSO# alca\t- Alcatraz - Run code agents unrestricted, but fearlessly Auto generated by spf13/cobra on 12-Feb-2026# "},{"id":22,"href":"/alcatraz/commands/alca_status/","title":"alca status","section":"Command Reference","content":"alca status# Show current Alcatraz status\nSynopsis# Display the current status of Alcatraz sandbox configuration and running processes.\nalca status [flags]Options# -h, --help help for statusSEE ALSO# alca\t- Alcatraz - Run code agents unrestricted, but fearlessly Auto generated by spf13/cobra on 12-Feb-2026# "},{"id":23,"href":"/alcatraz/commands/alca_up/","title":"alca up","section":"Command Reference","content":"alca up# Start the sandbox environment\nSynopsis# Start the Alcatraz sandbox environment based on the current configuration.\nalca up [flags]Options# -f, --force Force rebuild without confirmation on config change -h, --help help for up -q, --quiet Suppress progress outputSEE ALSO# alca\t- Alcatraz - Run code agents unrestricted, but fearlessly Auto generated by spf13/cobra on 12-Feb-2026# "}]